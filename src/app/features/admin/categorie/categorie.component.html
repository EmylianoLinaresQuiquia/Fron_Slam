
			<main class="main-content-wrapper">
				<div class="container">
					<!-- row -->
					<div class="row mb-8">
						<div class="col-md-12">
							<div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-4">
								<!-- pageheader -->
								<div>
									<h2>Categorias</h2>

								</div>
								<!-- button -->
								<div>
									<a data-bs-toggle="modal"
                  data-bs-target="#addCategoryModal"
                   class="btn btn-primary">Agregar nueva Categoria</a>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xl-12 col-12 mb-5">
							<!-- card -->
							<div class="card h-100 card-lg">
								<div class="px-6 py-6">
									<div class="row justify-content-between">
										<div class="col-lg-4 col-md-6 col-12 mb-2 mb-md-0">
											 <!-- form -->
                       <form class="d-flex" role="search">
                        <input
                          class="form-control"
                          type="search"
                          placeholder="Buscar Categoria"
                          aria-label="Search"
                          [(ngModel)]="searchQuery"
                          (input)="applyFilters()"
                          name="searchQuery"
                        />
                      </form>
										</div>

									</div>
								</div>
								<!-- card body -->
								<div class="card-body p-0">
									<!-- table -->
					        <div class="table-responsive">
                    <table class="table table-centered table-hover mb-0 text-nowrap table-borderless table-with-checkbox">
                      <thead class="bg-light">
                        <tr>
                          <th>
                            <div class="form-check">
                              <input class="form-check-input" type="checkbox" id="checkAll" />
                              <label class="form-check-label" for="checkAll"></label>
                            </div>
                          </th>
                          <th>Nombre</th>
                          <th>Descripción</th>
                          <th>Desplegar</th>
                          <th>Acciones</th>
                        </tr>
                      </thead>
                      <tbody>
                        <!-- Categorías -->
                        <ng-container *ngFor="let categoria of filteredCategorias">
                          <tr>
                            <td>
                              <div class="form-check">
                                <input
                                  class="form-check-input"
                                  type="checkbox"
                                  [value]="categoria.idCategoria"
                                />
                                <label class="form-check-label"></label>
                              </div>
                            </td>
                            <td>
                              <a class="text-reset">{{ categoria.nombre }}</a>
                            </td>
                            <td>{{ categoria.descripcion }}</td>
                            <td>
                              <button
                                class="btn btn-link text-decoration-none"
                                type="button"
                                data-bs-toggle="collapse"
                                [attr.data-bs-target]="'#collapse-' + categoria.idCategoria"
                                aria-expanded="false"
                                [attr.aria-controls]="'collapse-' + categoria.idCategoria"
                              >
                                <i class="bi bi-chevron-down"></i>
                              </button>
                            </td>
                            <td>
                              <div class="dropdown">
                                <a
                                  class="text-reset"
                                  data-bs-toggle="dropdown"
                                  aria-expanded="false"
                                >
                                  <i class="feather-icon icon-more-vertical fs-5"></i>
                                </a>
                                <ul class="dropdown-menu">
                                  <li>
                                    <a
                                      class="dropdown-item"
                                      data-bs-toggle="modal"
                                      data-bs-target="#addSubcategoryModal"
                                      (click)="openAddSubcategoryModal(categoria)"
                                    >
                                      <i class="bi bi-plus-circle me-3"></i> Agregar subcategoría
                                    </a>
                                  </li>
                                  <li>
                                    <a
                                      class="dropdown-item"
                                      (click)="deleteCategoria(categoria.idCategoria!)"
                                    >
                                      <i class="bi bi-trash me-3"></i> Eliminar
                                    </a>
                                  </li>
                                  <li>
                                    <a
                                      class="dropdown-item"
                                      data-bs-toggle="modal"
                                      data-bs-target="#editCategoryModal"
                                      (click)="prepareCategoriaEditModal(categoria)"
                                    >
                                      <i class="bi bi-pencil-square me-3"></i> Editar
                                    </a>
                                  </li>
                                </ul>
                              </div>
                            </td>
                          </tr>
                          <!-- Subcategorías debajo de la fila correspondiente -->
                          <tr class="collapse" [id]="'collapse-' + categoria.idCategoria">
                            <td colspan="5">
                              <div *ngIf="categoria.subcategorias && categoria.subcategorias.length > 0">
                                <table class="table table-borderless mb-0">
                                  <thead>
                                    <tr>
                                      <td></td>
                                      <td>Nombre</td>
                                      <td>Descripcion</td>

                                      <td>Acciones</td>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr *ngFor="let subcategoria of categoria.subcategorias">
                                      <td></td>
                                      <td>{{ subcategoria.nombre }}</td>
                                      <td>{{ subcategoria.descripcion }}</td>
                                      <td>
                                        <div class="dropdown">
                                          <a
                                            class="text-reset"
                                            data-bs-toggle="dropdown"
                                            aria-expanded="false"
                                          >
                                            <i class="feather-icon icon-more-vertical fs-5"></i>
                                          </a>
                                          <ul class="dropdown-menu">
                                            <li>
                                              <a
                                                class="dropdown-item"
                                                (click)="deleteSubcategory(subcategoria.id_subcategoria!, categoria.idCategoria!)"
                                              >
                                                <i class="bi bi-trash me-3"></i> Eliminar
                                              </a>
                                            </li>
                                            <li>
                                              <a
                                              class="dropdown-item"
                                              data-bs-toggle="modal"
                                              data-bs-target="#editSubcategoryModal"
                                              (click)="prepareEditSubcategoryModal(subcategoria, categoria.idCategoria)"
                                            >
                                              <i class="bi bi-pencil-square me-3"></i> Editar
                                            </a>


                                            </li>
                                          </ul>
                                        </div>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                              <div
                                *ngIf="categoria.subcategorias && categoria.subcategorias.length === 0"
                                class="text-muted"
                              >
                                No hay subcategorías para esta categoría.
                              </div>
                            </td>
                          </tr>
                        </ng-container>
                      </tbody>
                    </table>
                  </div>


								</div>

							</div>
						</div>
					</div>
				</div>
			</main>





      <!-- Modal Agregar SubCategoría -->
      <div
      class="modal fade"
      id="addSubcategoryModal"
      tabindex="-1"
      aria-labelledby="addSubcategoryModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" style="max-width: 900px; margin-right: 100px;">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addSubcategoryModalLabel">Agregar Subcategoría</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Cerrar"
            ></button>
          </div>
          <div class="modal-body">
            <form [formGroup]="subcategoryForm">
              <!-- Nombre -->
              <div class="mb-3">
                <label for="nombre" class="form-label">Nombre</label>
                <input
                  id="nombre"
                  type="text"
                  class="form-control"
                  formControlName="nombre"
                  placeholder="Ingresa el nombre de la subcategoría"
                />
              </div>
              <!-- Descripción -->
              <div class="mb-3">
                <label for="descripcion" class="form-label">Descripción</label>
                <textarea
                  id="descripcion"
                  class="form-control"
                  formControlName="descripcion"
                  placeholder="Ingresa la descripción de la subcategoría"
                ></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-primary"
              (click)="createSubcategory()"
            >
              Guardar
            </button>
          </div>
        </div>
      </div>
    </div>


<!-- Modal editar SubCategoría -->
    <div
  class="modal fade"
  id="editSubcategoryModal"
  tabindex="-1"
  aria-labelledby="editSubcategoryModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog" style="max-width: 900px; margin-right: 100px;">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editSubcategoryModalLabel">Editar Subcategoría</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Cerrar"
        ></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="editSubcategoryForm">
          <!-- Nombre -->
          <div class="mb-3">
            <label for="editNombre" class="form-label">Nombre</label>
            <input
              id="editNombre"
              type="text"
              class="form-control"
              formControlName="nombre"
              placeholder="Nombre de la subcategoría"
            />
          </div>
          <!-- Descripción -->
          <div class="mb-3">
            <label for="editDescripcion" class="form-label">Descripción</label>
            <textarea
              id="editDescripcion"
              class="form-control"
              formControlName="descripcion"
              placeholder="Descripción de la subcategoría"
            ></textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs-dismiss="modal"
        >
          Cancelar
        </button>
        <button
          type="button"
          class="btn btn-primary"
          (click)="updateSubcategory()"
        >
          Guardar cambios
        </button>
      </div>
    </div>
  </div>
</div>





<!-- Modal Agregar Categoría -->

<div
  class="modal fade"
  id="addCategoryModal"
  tabindex="-1"
  aria-labelledby="addCategoryModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog" style="max-width: 900px; margin-right: 100px;">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addCategoryModalLabel">Agregar Categoría</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Cerrar"
        ></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="form">
          <!-- Nombre -->
          <div class="mb-3">
            <label for="nombre" class="form-label">Nombre</label>
            <input
              id="nombre"
              type="text"
              class="form-control"
              formControlName="nombre"
              placeholder="Ingresa el nombre de la categoría"
            />
          </div>
          <!-- Descripción -->
          <div class="mb-3">
            <label for="descripcion" class="form-label">Descripción</label>
            <textarea
              id="descripcion"
              class="form-control"
              formControlName="descripcion"
              placeholder="Ingresa la descripción de la categoría"
            ></textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs-dismiss="modal"
        >
          Cancelar
        </button>
        <button
          type="button"
          class="btn btn-primary"
          (click)="createCategoria()"
        >
          Guardar
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Editar Categoría -->
<div
  class="modal fade"
  id="editCategoryModal"
  tabindex="-1"
  aria-labelledby="editCategoryModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog" style="max-width: 900px; margin-right: 100px;">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editCategoryModalLabel">Editar Categoría</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Cerrar"
        ></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="form">
          <!-- ID (Solo para visualización) -->

          <!-- Nombre -->
          <div class="mb-3">
            <label for="nombre" class="form-label">Nombre</label>
            <input
              id="nombre"
              type="text"
              class="form-control"
              formControlName="nombre"
              placeholder="Ingresa el nombre de la categoría"
            />
          </div>
          <!-- Descripción -->
          <div class="mb-3">
            <label for="descripcion" class="form-label">Descripción</label>
            <textarea
              id="descripcion"
              class="form-control"
              formControlName="descripcion"
              placeholder="Ingresa la descripción de la categoría"
            ></textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs-dismiss="modal"
        >
          Cancelar
        </button>
        <button
          type="button"
          class="btn btn-primary"
          (click)="updateCategoria()">

          Guardar Cambios
        </button>
      </div>
    </div>
  </div>
</div>




